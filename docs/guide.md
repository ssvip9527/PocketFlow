---
layout: default
title: "Agentic ç¼–ç¨‹"
---

# Agentic ç¼–ç¨‹ï¼šäººç±»è®¾è®¡ï¼Œæ™ºèƒ½ä½“ç¼–ç ï¼

> å¦‚æœä½ æ˜¯ä¸€ä¸ªå‚ä¸æ„å»º LLM ç³»ç»Ÿçš„ AI æ™ºèƒ½ä½“ï¼Œè¯·**éå¸¸ã€éå¸¸**ä»”ç»†åœ°é˜…è¯»æœ¬æŒ‡å—ï¼è¿™æ˜¯æ•´ä¸ªæ–‡æ¡£ä¸­æœ€é‡è¦çš„ç« èŠ‚ã€‚åœ¨æ•´ä¸ªå¼€å‘è¿‡ç¨‹ä¸­ï¼Œä½ åº”è¯¥å§‹ç»ˆ (1) ä»å°è€Œç®€å•çš„è§£å†³æ–¹æ¡ˆå¼€å§‹ï¼Œ(2) åœ¨å®ç°ä¹‹å‰è¿›è¡Œé«˜å±‚è®¾è®¡ï¼ˆ`docs/design.md`ï¼‰ï¼Œä»¥åŠ (3) ç»å¸¸å‘äººç±»å¯»æ±‚åé¦ˆå’Œæ¾„æ¸…ã€‚
{: .warning }

## Agentic ç¼–ç¨‹æ­¥éª¤

Agentic ç¼–ç¨‹åº”è¯¥æ˜¯äººç±»ç³»ç»Ÿè®¾è®¡å’Œæ™ºèƒ½ä½“å®ç°ä¹‹é—´çš„åä½œï¼š

| æ­¥éª¤                  | äººç±»      | AI        | è¯„è®º                                                                 |
|:-----------------------|:----------:|:---------:|:------------------------------------------------------------------------|
| 1. éœ€æ±‚ | â˜…â˜…â˜… é«˜  | â˜…â˜†â˜† ä½   | äººç±»ç†è§£éœ€æ±‚å’Œä¸Šä¸‹æ–‡ã€‚                    |
| 2. æµç¨‹          | â˜…â˜…â˜† ä¸­ | â˜…â˜…â˜† ä¸­ |  äººç±»æŒ‡å®šé«˜å±‚è®¾è®¡ï¼ŒAI å¡«å……ç»†èŠ‚ã€‚ |
| 3. å·¥å…·   | â˜…â˜…â˜† ä¸­ | â˜…â˜…â˜† ä¸­ | äººç±»æä¾›å¯ç”¨çš„å¤–éƒ¨ API å’Œé›†æˆï¼ŒAI ååŠ©å®ç°ã€‚ |
| 4. èŠ‚ç‚¹          | â˜…â˜†â˜† ä½   | â˜…â˜…â˜… é«˜  | AI ååŠ©æ ¹æ®æµç¨‹è®¾è®¡èŠ‚ç‚¹ç±»å‹å’Œæ•°æ®å¤„ç†ã€‚          |
| 5. å®ç°      | â˜…â˜†â˜† ä½   | â˜…â˜…â˜… é«˜  |  AI æ ¹æ®è®¾è®¡å®ç°æµç¨‹ã€‚ |
| 6. ä¼˜åŒ–        | â˜…â˜…â˜† ä¸­ | â˜…â˜…â˜† ä¸­ | äººç±»è¯„ä¼°ç»“æœï¼ŒAI ååŠ©ä¼˜åŒ–ã€‚ |
| 7. å¯é æ€§         | â˜…â˜†â˜† ä½   | â˜…â˜…â˜… é«˜  |  AI ç¼–å†™æµ‹è¯•ç”¨ä¾‹å¹¶å¤„ç†è¾¹ç¼˜æƒ…å†µã€‚     |

1. **éœ€æ±‚**ï¼šæ˜ç¡®é¡¹ç›®çš„éœ€æ±‚ï¼Œå¹¶è¯„ä¼° AI ç³»ç»Ÿæ˜¯å¦é€‚åˆã€‚
    - ç†è§£ AI ç³»ç»Ÿçš„ä¼˜åŠ¿å’Œå±€é™æ€§ï¼š
      - **é€‚ç”¨äº**ï¼šéœ€è¦å¸¸è¯†çš„æ—¥å¸¸ä»»åŠ¡ï¼ˆå¡«å†™è¡¨æ ¼ã€å›å¤é‚®ä»¶ï¼‰
      - **é€‚ç”¨äº**ï¼šè¾“å…¥æ˜ç¡®çš„åˆ›æ„ä»»åŠ¡ï¼ˆåˆ¶ä½œå¹»ç¯ç‰‡ã€ç¼–å†™ SQLï¼‰
      - **ä¸é€‚ç”¨äº**ï¼šéœ€è¦å¤æ‚å†³ç­–çš„æ¨¡ç³Šé—®é¢˜ï¼ˆå•†ä¸šç­–ç•¥ã€åˆ›ä¸šè§„åˆ’ï¼‰
    - **ä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒ**ï¼šä»ç”¨æˆ·çš„è§’åº¦è§£é‡Šâ€œé—®é¢˜â€ï¼Œè€Œä¸ä»…ä»…æ˜¯åˆ—å‡ºåŠŸèƒ½ã€‚
    - **å¹³è¡¡å¤æ‚æ€§ä¸å½±å“**ï¼šæ—¨åœ¨æ—©æœŸä»¥æœ€å°çš„å¤æ‚æ€§äº¤ä»˜æœ€é«˜ä»·å€¼çš„åŠŸèƒ½ã€‚

2. **æµç¨‹è®¾è®¡**ï¼šé«˜å±‚æ¦‚è¿°ï¼Œæè¿° AI ç³»ç»Ÿå¦‚ä½•ç¼–æ’èŠ‚ç‚¹ã€‚
    - è¯†åˆ«é€‚ç”¨çš„è®¾è®¡æ¨¡å¼ï¼ˆä¾‹å¦‚ï¼Œ[Map Reduce](./design_pattern/mapreduce.md)ã€[Agent](./design_pattern/agent.md)ã€[RAG](./design_pattern/rag.md)ï¼‰ã€‚
      - å¯¹äºæµç¨‹ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ï¼Œä»å…¶åŠŸèƒ½çš„é«˜å±‚å•è¡Œæè¿°å¼€å§‹ã€‚
      - å¦‚æœä½¿ç”¨ **Map Reduce**ï¼Œè¯·æŒ‡å®šå¦‚ä½•æ˜ å°„ï¼ˆæ‹†åˆ†ä»€ä¹ˆï¼‰å’Œå¦‚ä½•å½’çº¦ï¼ˆå¦‚ä½•ç»„åˆï¼‰ã€‚
      - å¦‚æœä½¿ç”¨ **Agent**ï¼Œè¯·æŒ‡å®šè¾“å…¥ï¼ˆä¸Šä¸‹æ–‡ï¼‰å’Œå¯èƒ½çš„åŠ¨ä½œã€‚
      - å¦‚æœä½¿ç”¨ **RAG**ï¼Œè¯·æŒ‡å®šè¦åµŒå…¥çš„å†…å®¹ï¼Œæ³¨æ„é€šå¸¸æœ‰ç¦»çº¿ï¼ˆç´¢å¼•ï¼‰å’Œåœ¨çº¿ï¼ˆæ£€ç´¢ï¼‰å·¥ä½œæµã€‚
    - æ¦‚è¿°æµç¨‹å¹¶ç”¨ mermaid å›¾ç»˜åˆ¶ã€‚ä¾‹å¦‚ï¼š
      ```mermaid
      flowchart LR
          start[Start] --> batch[Batch]
          batch --> check[Check]
          check -->|OK| process
          check -->|Error| fix[Fix]
          fix --> check
          
          subgraph process[Process]
            step1[Step 1] --> step2[Step 2]
          end
          
          process --> endNode[End]
      ```
    - > **å¦‚æœäººç±»æ— æ³•æŒ‡å®šæµç¨‹ï¼ŒAI æ™ºèƒ½ä½“å°±æ— æ³•è‡ªåŠ¨åŒ–ï¼** åœ¨æ„å»º LLM ç³»ç»Ÿä¹‹å‰ï¼Œé€šè¿‡æ‰‹åŠ¨è§£å†³ç¤ºä¾‹è¾“å…¥æ¥å½»åº•ç†è§£é—®é¢˜å’Œæ½œåœ¨è§£å†³æ–¹æ¡ˆï¼Œä»¥åŸ¹å…»ç›´è§‰ã€‚  
      {: .best-practice }

3. **å·¥å…·**ï¼šæ ¹æ®æµç¨‹è®¾è®¡ï¼Œè¯†åˆ«å¹¶å®ç°å¿…è¦çš„å·¥å…·å‡½æ•°ã€‚
    - å°† AI ç³»ç»Ÿè§†ä¸ºå¤§è„‘ã€‚å®ƒéœ€è¦ä¸€ä¸ªèº«ä½“â€”â€”è¿™äº›*å¤–éƒ¨å·¥å…·å‡½æ•°*â€”â€”æ¥ä¸ç°å®ä¸–ç•Œäº’åŠ¨ï¼š
        <div align="center"><img src="https://github.com/the-pocket/.github/raw/main/assets/utility.png?raw=true" width="400"/></div>

        - è¯»å–è¾“å…¥ï¼ˆä¾‹å¦‚ï¼Œæ£€ç´¢ Slack æ¶ˆæ¯ï¼Œé˜…è¯»ç”µå­é‚®ä»¶ï¼‰
        - å†™å…¥è¾“å‡ºï¼ˆä¾‹å¦‚ï¼Œç”ŸæˆæŠ¥å‘Šï¼Œå‘é€ç”µå­é‚®ä»¶ï¼‰
        - ä½¿ç”¨å¤–éƒ¨å·¥å…·ï¼ˆä¾‹å¦‚ï¼Œè°ƒç”¨ LLMï¼Œæœç´¢ç½‘é¡µï¼‰
        - **æ³¨æ„**ï¼š*åŸºäº LLM çš„ä»»åŠ¡*ï¼ˆä¾‹å¦‚ï¼Œæ–‡æœ¬æ‘˜è¦ï¼Œæƒ…æ„Ÿåˆ†æï¼‰**ä¸æ˜¯**å·¥å…·å‡½æ•°ï¼›ç›¸åï¼Œå®ƒä»¬æ˜¯ AI ç³»ç»Ÿå†…éƒ¨çš„*æ ¸å¿ƒåŠŸèƒ½*ã€‚
    - å¯¹äºæ¯ä¸ªå·¥å…·å‡½æ•°ï¼Œå®ç°å®ƒå¹¶ç¼–å†™ä¸€ä¸ªç®€å•çš„æµ‹è¯•ã€‚
    - è®°å½•å®ƒä»¬çš„è¾“å…¥/è¾“å‡ºï¼Œä»¥åŠä¸ºä»€ä¹ˆå®ƒä»¬æ˜¯å¿…è¦çš„ã€‚ä¾‹å¦‚ï¼š
      - `åç§°`ï¼š`get_embedding` (`utils/get_embedding.py`)
      - `è¾“å…¥`ï¼š`str`
      - `è¾“å‡º`ï¼šä¸€ä¸ªåŒ…å« 3072 ä¸ªæµ®ç‚¹æ•°çš„å‘é‡
      - `å¿…è¦æ€§`ï¼šç”±ç¬¬äºŒä¸ªèŠ‚ç‚¹ç”¨äºåµŒå…¥æ–‡æœ¬
    - å·¥å…·å®ç°ç¤ºä¾‹ï¼š
      ```python
      # utils/call_llm.py
      from openai import OpenAI

      def call_llm(prompt):    
          client = OpenAI(api_key="YOUR_API_KEY_HERE")
          r = client.chat.completions.create(
              model="gpt-4o",
              messages=[{"role": "user", "content": prompt}]
          )
          return r.choices[0].message.content
          
      if __name__ == "__main__":
          prompt = "What is the meaning of life?"
          print(call_llm(prompt))
      ```
    - > **æœ‰æ—¶ï¼Œåœ¨æµç¨‹ä¹‹å‰è®¾è®¡å·¥å…·ï¼š** ä¾‹å¦‚ï¼Œå¯¹äºä¸€ä¸ªè‡ªåŠ¨åŒ–é—ç•™ç³»ç»Ÿçš„ LLM é¡¹ç›®ï¼Œç“¶é¢ˆå¾ˆå¯èƒ½æ˜¯è¯¥ç³»ç»Ÿå¯ç”¨çš„æ¥å£ã€‚ä»è®¾è®¡æœ€éš¾çš„æ¥å£å·¥å…·å¼€å§‹ï¼Œç„¶åå›´ç»•å®ƒä»¬æ„å»ºæµç¨‹ã€‚
      {: .best-practice }

4. **èŠ‚ç‚¹è®¾è®¡**ï¼šè§„åˆ’æ¯ä¸ªèŠ‚ç‚¹å¦‚ä½•è¯»å†™æ•°æ®ï¼Œå¹¶ä½¿ç”¨å·¥å…·å‡½æ•°ã€‚
   - PocketFlow çš„ä¸€ä¸ªæ ¸å¿ƒè®¾è®¡åŸåˆ™æ˜¯ä½¿ç”¨[å…±äº«å­˜å‚¨](./core_abstraction/communication.md)ï¼Œå› æ­¤ä»å…±äº«å­˜å‚¨è®¾è®¡å¼€å§‹ï¼š
      - å¯¹äºç®€å•ç³»ç»Ÿï¼Œä½¿ç”¨å†…å­˜å­—å…¸ã€‚
      - å¯¹äºæ›´å¤æ‚çš„ç³»ç»Ÿæˆ–éœ€è¦æŒä¹…åŒ–æ—¶ï¼Œä½¿ç”¨æ•°æ®åº“ã€‚
      - **ä¸è¦é‡å¤è‡ªå·±**ï¼šä½¿ç”¨å†…å­˜å¼•ç”¨æˆ–å¤–é”®ã€‚
      - å…±äº«å­˜å‚¨è®¾è®¡ç¤ºä¾‹ï¼š
        ```python
        shared = {
            "user": {
                "id": "user123",
                "context": {                # Another nested dict
                    "weather": {"temp": 72, "condition": "sunny"},
                    "location": "San Francisco"
                }
            },
            "results": {}                   # Empty dict to store outputs
        }
        ```
   - å¯¹äºæ¯ä¸ª[èŠ‚ç‚¹](./core_abstraction/node.md)ï¼Œæè¿°å…¶ç±»å‹ã€å¦‚ä½•è¯»å†™æ•°æ®ä»¥åŠä½¿ç”¨å“ªä¸ªå·¥å…·å‡½æ•°ã€‚ä¿æŒå…·ä½“ä½†é«˜å±‚ï¼Œä¸æ¶‰åŠä»£ç ã€‚ä¾‹å¦‚ï¼š
     - `ç±»å‹`ï¼šå¸¸è§„ï¼ˆæˆ–æ‰¹å¤„ç†ï¼Œæˆ–å¼‚æ­¥ï¼‰
     - `å‡†å¤‡`ï¼šä»å…±äº«å­˜å‚¨ä¸­è¯»å–â€œæ–‡æœ¬â€
     - `æ‰§è¡Œ`ï¼šè°ƒç”¨åµŒå…¥å·¥å…·å‡½æ•°
     - `åå¤„ç†`ï¼šå°†â€œåµŒå…¥â€å†™å…¥å…±äº«å­˜å‚¨

5. **å®ç°**ï¼šæ ¹æ®è®¾è®¡å®ç°åˆå§‹èŠ‚ç‚¹å’Œæµç¨‹ã€‚
   - ğŸ‰ å¦‚æœä½ å·²è¾¾åˆ°æ­¤æ­¥éª¤ï¼Œäººç±»å·²å®Œæˆè®¾è®¡ã€‚ç°åœ¨*Agentic ç¼–ç¨‹*å¼€å§‹ï¼
   - **â€œä¿æŒç®€å•ï¼Œå‚»ç“œï¼â€** é¿å…å¤æ‚åŠŸèƒ½å’Œå…¨é¢çš„ç±»å‹æ£€æŸ¥ã€‚
   - **å¿«é€Ÿå¤±è´¥**ï¼é¿å… `try` é€»è¾‘ï¼Œä»¥ä¾¿å¿«é€Ÿè¯†åˆ«ç³»ç»Ÿä¸­çš„ä»»ä½•è–„å¼±ç‚¹ã€‚
   - åœ¨æ•´ä¸ªä»£ç ä¸­æ·»åŠ æ—¥å¿—è®°å½•ä»¥æ–¹ä¾¿è°ƒè¯•ã€‚

7. **ä¼˜åŒ–**ï¼š
   - **ä½¿ç”¨ç›´è§‰**ï¼šå¯¹äºå¿«é€Ÿåˆæ­¥è¯„ä¼°ï¼Œäººç±»ç›´è§‰é€šå¸¸æ˜¯ä¸€ä¸ªå¥½çš„å¼€å§‹ã€‚
   - **é‡æ–°è®¾è®¡æµç¨‹ï¼ˆå›åˆ°æ­¥éª¤ 3ï¼‰**ï¼šè€ƒè™‘è¿›ä¸€æ­¥åˆ†è§£ä»»åŠ¡ï¼Œå¼•å…¥æ™ºèƒ½ä½“å†³ç­–ï¼Œæˆ–æ›´å¥½åœ°ç®¡ç†è¾“å…¥ä¸Šä¸‹æ–‡ã€‚
   - å¦‚æœä½ çš„æµç¨‹è®¾è®¡å·²ç»å¾ˆå®Œå–„ï¼Œåˆ™è¿›è¡Œå¾®ä¼˜åŒ–ï¼š
     - **æç¤ºå·¥ç¨‹**ï¼šä½¿ç”¨æ¸…æ™°ã€å…·ä½“çš„æŒ‡ä»¤å’Œç¤ºä¾‹æ¥å‡å°‘æ­§ä¹‰ã€‚
     - **ä¸Šä¸‹æ–‡å­¦ä¹ **ï¼šä¸ºéš¾ä»¥ä»…å‡­æŒ‡ä»¤æŒ‡å®šçš„ä»»åŠ¡æä¾›å¯é çš„ç¤ºä¾‹ã€‚

   - > **ä½ å¯èƒ½ä¼šè¿›è¡Œå¤§é‡è¿­ä»£ï¼** é¢„è®¡ä¼šé‡å¤æ­¥éª¤ 3-6 æ•°ç™¾æ¬¡ã€‚
     >
     > <div align="center"><img src="https://github.com/the-pocket/.github/raw/main/assets/success.png?raw=true" width="400"/></div>
     {: .best-practice }

8. **å¯é æ€§**
   - **èŠ‚ç‚¹é‡è¯•**ï¼šåœ¨èŠ‚ç‚¹ `exec` ä¸­æ·»åŠ æ£€æŸ¥ï¼Œä»¥ç¡®ä¿è¾“å‡ºç¬¦åˆè¦æ±‚ï¼Œå¹¶è€ƒè™‘å¢åŠ  `max_retries` å’Œ `wait` æ—¶é—´ã€‚
   - **æ—¥å¿—è®°å½•å’Œå¯è§†åŒ–**ï¼šç»´æŠ¤æ‰€æœ‰å°è¯•çš„æ—¥å¿—ï¼Œå¹¶å¯è§†åŒ–èŠ‚ç‚¹ç»“æœï¼Œä»¥ä¾¿äºè°ƒè¯•ã€‚
   - **è‡ªæˆ‘è¯„ä¼°**ï¼šæ·»åŠ ä¸€ä¸ªå•ç‹¬çš„èŠ‚ç‚¹ï¼ˆç”± LLM æä¾›æ”¯æŒï¼‰ï¼Œåœ¨ç»“æœä¸ç¡®å®šæ—¶å®¡æŸ¥è¾“å‡ºã€‚

## LLM é¡¹ç›®æ–‡ä»¶ç»“æ„ç¤ºä¾‹

```
my_project/
â”œâ”€â”€ main.py
â”œâ”€â”€ nodes.py
â”œâ”€â”€ flow.py
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ call_llm.py
â”‚   â””â”€â”€ search_web.py
â”œâ”€â”€ requirements.txt
â””â”€â”€ docs/
    â””â”€â”€ design.md
```

- **`docs/design.md`**ï¼šåŒ…å«ä¸Šè¿°æ¯ä¸ªæ­¥éª¤çš„é¡¹ç›®æ–‡æ¡£ã€‚è¿™åº”è¯¥æ˜¯*é«˜å±‚*ä¸”*æ— ä»£ç *çš„ã€‚
- **`utils/`**ï¼šåŒ…å«æ‰€æœ‰å·¥å…·å‡½æ•°ã€‚
  - å»ºè®®ä¸ºæ¯ä¸ª API è°ƒç”¨ä¸“é—¨åˆ›å»ºä¸€ä¸ª Python æ–‡ä»¶ï¼Œä¾‹å¦‚ `call_llm.py` æˆ– `search_web.py`ã€‚
  - æ¯ä¸ªæ–‡ä»¶è¿˜åº”åŒ…å«ä¸€ä¸ª `main()` å‡½æ•°æ¥å°è¯•è¯¥ API è°ƒç”¨
- **`nodes.py`**ï¼šåŒ…å«æ‰€æœ‰èŠ‚ç‚¹å®šä¹‰ã€‚
  ```python
  # nodes.py
  from pocketflow import Node
  from utils.call_llm import call_llm

  class GetQuestionNode(Node):
      def exec(self, _):
          # Get question directly from user input
          user_question = input("Enter your question: ")
          return user_question
      
      def post(self, shared, prep_res, exec_res):
          # Store the user's question
          shared["question"] = exec_res
          return "default"  # Go to the next node

  class AnswerNode(Node):
      def prep(self, shared):
          # Read question from shared
          return shared["question"]
      
      def exec(self, question):
          # Call LLM to get the answer
          return call_llm(question)
      
      def post(self, shared, prep_res, exec_res):
          # Store the answer in shared
          shared["answer"] = exec_res
  ```
- **`flow.py`**ï¼šå®ç°é€šè¿‡å¯¼å…¥èŠ‚ç‚¹å®šä¹‰å¹¶è¿æ¥å®ƒä»¬æ¥åˆ›å»ºæµç¨‹çš„å‡½æ•°ã€‚
  ```python
  # flow.py
  from pocketflow import Flow
  from nodes import GetQuestionNode, AnswerNode

  def create_qa_flow():
      """Create and return a question-answering flow."""
      # Create nodes
      get_question_node = GetQuestionNode()
      answer_node = AnswerNode()
      
      # Connect nodes in sequence
      get_question_node >> answer_node
      
      # Create flow starting with input node
      return Flow(start=get_question_node)
  ```
- **`main.py`**ï¼šä½œä¸ºé¡¹ç›®çš„å…¥å£ç‚¹ã€‚
  ```python
  # main.py
  from flow import create_qa_flow

  # Example main function
  # è¯·å°†å…¶æ›¿æ¢ä¸ºæ‚¨è‡ªå·±çš„ä¸»å‡½æ•°
  def main():
      shared = {
          "question": None,  # Will be populated by GetQuestionNode from user input
          "answer": None     # Will be populated by AnswerNode
      }

      # Create the flow and run it
      qa_flow = create_qa_flow()
      qa_flow.run(shared)
      print(f"Question: {shared['question']}")
      print(f"Answer: {shared['answer']}")

  if __name__ == "__main__":
      main()
  ```
